(defcfg
  linux-continue-if-no-devs-found yes
  process-unmapped-keys yes
  concurrent-tap-hold yes
  chords-v2-min-idle 50
  danger-enable-cmd yes
)

;; keys to be used in the layers
;; (defsrc
;;   1 2 3 4 5   7 8 9  0 -
;;   q w e r t   u i o  p [
;;   a s d f g   j k l ï¸” '
;;         c v   m â¸´
;; )
(defsrc
  q w e r t   y u i o  p
  a s d f g   h j k l ï¸”
  z x c v b   n m â¸´ .  â„
        3 4   7 8
)
(defchordsv2
  (t! crd (j k) ')
  (t! crd (x c) C-c)
  (t! crd (c v) C-v)
  (t! crd (x v) C-x)
  (t! crd (x c v) C-z)
  (t! crd (w e) â‹)
  (t! crd (i o) âŒ«)
  (t! crd (, .) âŒ¦)
  (t! crd (s d) â)
  (t! crd (d f) â­¾)
  (t! crd (k l) â)
)
(deftemplate crd (chord action)
  $chord $action $ct first-release ()
)

(defvar
  tap-timeout 200
  hold-timeout 150
  hold-timeout-pinky 200
  hold-timeout-long 1000
  chord-timeout 30

  tt  $tap-timeout
  ht  $hold-timeout
  htp $hold-timeout-pinky
  htl $hold-timeout-long
  ct  $chord-timeout
)

;; home (top) row mods
(defalias
  q (tap-hold $tt $htp (multi q u) q)
  s (tap-hold $tt $ht s â€¹â‡)
  e (tap-hold $tt $ht e â€¹âŒƒ)
  f (tap-hold $tt $ht f â€¹â–)
  j (tap-hold $tt $ht j â–â€º)
  i (tap-hold $tt $ht i âŒƒâ€º)
  l (tap-hold $tt $ht l â‡â€º)

  ğŸ”  (layer-switch base)
  â†‘â†“ (layer-toggle navigation)
  ğŸ”¢ (chord layers ğŸ”¢)
  ğŸ”£ (chord layers ğŸ”£)
  ğŸ–±ï¸ (layer-switch mouse)

  âŸ³ rpt

  meh (multi â€¹âŒƒ â€¹â‡ â€¹â‡§)

  â£â†‘â†“ (chord layers â£â†‘â†“)
  â‡§   (chord layers â‡§)

  â®¸ (caps-word-custom $htl
      (a b c d e f g h i j k l m n o p q r s t u v w x y z)
      (âŒ« âŒ¦ â–² â—€ â–¼ â–¶)
  )
)
;;base layer is the first layer defined
(deflayer base
   q     w    @e     r     t     y     u    @i     o     p
   a    @s     d    @f     g     h    @j     k    @l    ï¸”
   z     x     c     v     b     n     m     â¸´     .     /
                   @ğŸ”¢    @â£â†‘â†“  @â‡§    @ğŸ”£
)
(defchords layers $ct
  (ğŸ”¢   ) (layer-toggle num)
  (   ğŸ”£) (layer-toggle sym)
  (ğŸ”¢ ğŸ”£) @ğŸ–±ï¸
  (â£â†‘â†“  ) (tapâ¬“â†‘ $tt $ht â£ @â†‘â†“)
  (    â‡§) â€¹â‡§
  (â£â†‘â†“ â‡§) (tap-hold $tt $htl @â®¸ â‡ª)
  (ğŸ”¢ â£â†‘â†“) @meh
)

(defalias
  !  S-1
  ï¼  S-2
  âŒ—  S-3
  $  S-4
  Ùª  S-5
  âˆ§  S-6
  ï¼† S-7
  âˆ—  (chord syms âˆ—)
 ã€”  S-9
  ã€• S-0
  Ëœ  S-Ë‹
  -  min
  _  S-min
  ï¼‹ (chord syms ï¼‹)
  |  S-\
  ]  ]
  [  (chord syms [)
  â´  S-[
  âµ  S-]
  :  S-;
  âŸ¨  S-,
  âŸ©  S-.
  ?  S-â„
  â€  (chord syms â€)
  êŒ  '
)
(deflayer sym
   â€¢     -    @ï¼‹   @âˆ—    @âŒ—     â€¢    @âˆ§    ï¸”    @$     â€¢
  @â€    @[    @ã€”   @â´     \     â€¢    @âµ    @ã€•   @]    @Ùª
   â€¢    @ï¼†   @|    @!    @âŸ¨    @âŸ©    @Ëœ    @ï¼    @_     â€¢
                     =     â£     â€¢     _
)
(defchords syms $ct
  (â€  ) S-'
  (  [) [
  (â€ [) `
  (ï¼‹  ) S-eql
  (   âˆ—) S-8
  (ï¼‹ âˆ—) (multi = S-.) ;; =>
)

(defalias
  grp (layer-switch graphite)
  qwr (layer-switch qwerty)

  â†’â†‘â†“ (layer-switch navigation)
  ğŸ” ğŸ”¢ (tapâ¬“â†‘ $tt $ht @ğŸ”  @ğŸ”¢)

  fa (multi (cmd sh -c 'setxkbmap -layout "ir"') (layer-switch farsi))
  en (multi (cmd sh -c 'setxkbmap -layout "en"') @ğŸ” )
)

(deflayer navigation
   q    @fa   â€¹âŒƒ    @en   @qwr   â—€â—€    â†–     â–²     â†˜     â–¶â–¶
  @ğŸ”    â€¹â‡    â€¹âŒƒ    â€¹â–    @grp   ğŸ”‰    â—€     â–¼     â–¶     ğŸ”Š
   â€¢     â€¢     â€¢    @â†’â†‘â†“   â€¢     â–¶â¸    â‡     o     â‡Ÿ     ğŸ”‡
                    @ğŸ”¢   â€¹â‡§     â£    @ğŸ”£
)

(defalias
  1  (tap-hold $tt $htl 1    f1)
  2  (tap-hold $tt $htl 2    f2)
  3  (tap-hold $tt $htl 3    f3)
  4  (tap-hold $tt $htl 4    f4)
  5  (tap-hold $tt $htl 5    f5)
  6  (tap-hold $tt $htl 6    f6)
  7  (tap-hold $tt $htl 7    f7)
  8  (tap-hold $tt $htl 8    f8)
  9  (tap-hold $tt $htl 9    f9)
  br (tap-hold $tt $htl brk  f10)
  pr (tap-hold $tt $htl prnt f11)
  in (tap-hold $tt $htl â€    f12)
)
(deflayer num
  @âˆ—     â€    @ï¼‹    =    @Ùª    @in   @4    @5    @6     â€¢
   â„    â€¹â‡    â€¹âŒƒ    â€¹â–     â€¢    @pr   @1    @2    @3     0
   â€¢     â€¢     â¸´     .     â€¢    @br   @7    @8    @9     â€¢
                     _     â£    â€¹â‡§    @ğŸ–±ï¸
)

(defalias
  ;; mousewheel: interval, distance
  wu (ğŸ–±â˜¸â†‘ 50 120)
  wd (ğŸ–±â˜¸â†“ 50 120)
  wl (ğŸ–±â˜¸â† 50 480)
  wr (ğŸ–±â˜¸â†’ 50 480)

  ;; movemouse-speed: percent
  s0 (ğŸ–±speed 25)
  s1 (ğŸ–±speed 150)
  s2 (ğŸ–±speed 250)

  ;; movemouse: interval, distance
  mu (ğŸ–±â†‘ 8 4)
  md (ğŸ–±â†“ 8 4)
  ml (ğŸ–±â† 8 4)
  mr (ğŸ–±â†’ 8 4)
  ğŸ”„ğŸ–±ï¸ (layer-switch mouser)
)
(deflayer mouse
   â€¢    @wu   @mu   @wd   @ğŸ”„ğŸ–±ï¸  â€¢     â€¢    â€¹â‡§     â€¢    @s2
  @wl   @ml   @md   @mr   @wr   mmid  â€¹â–    â€¹âŒƒ    â€¹â‡    @s1
   â€¢     â€¢     â€¢     â€¢     â€¢     â€¢    mbtp  mftp   â€¢    @s0
                     @ğŸ”    â€¢    mlft  mrgt
)
(deflayer mouser
  @s2    â€¢    â€¹â‡§     â€¢     â€¢    @ğŸ–±ï¸   @wd   @mu   @wu    â€¢
  @s1   â€¹â‡    â€¹âŒƒ    â€¹â–    mmid  @wl   @ml   @md   @mr   @wr
  @s0    â€¢     â€¢     â€¢     â€¢     â€¢     â€¢     â€¢     â€¢     â€¢
                     @ğŸ”    â€¢    mlft  mrgt
)

(defalias
  lg  (tap-hold $tt $ht l â€¹â‡)
  dg  (tap-hold $tt $ht d â€¹âŒƒ)
  wg  (tap-hold $tt $ht w â€¹â–)
  fg  (tap-hold $tt $ht f â–â€º)
  og  (tap-hold $tt $ht o âŒƒâ€º)
  ug  (tap-hold $tt $ht u â‡â€º)
)
(deflayer graphite
   b    @lg   @dg   @wg    q     j    @fg   @og   @ug    ;
   n     r     t     s     g     y     h     a     e     i
   z     x     m     c     v     k     p     â¸´     .     /
                   @ğŸ”¢    @â£â†‘â†“  â€¹â‡§    @ğŸ”£
)

(defalias
  Ø§  h
  Ø¨  f
  Ù¾  m
  Øª  j
  Ø«  e
  Ø¬  [
  Ú†  ]
  Ø­  p
  Ø®  o
  Ø¯  n
  Ø°  b
  Ø±  v
  Ø²  c
  Ú˜  S-c
  Ø³  s
  Ø´  a
  Øµ  w
  Ø¶  q
  Ø·  x
  Ø¸  z
  Ø¹  u
  Øº  y
  Ù  t
  Ù‚  r
  Ú© ï¸”
  Ú¯  '
  Ù„  g
  Ù…  l
  Ù†  k
  Ùˆ  â¸´
  Ù‡  i
  ÛŒ  d
  ØŒ  S-7
  .   (tapâ¬“â†‘  $tt $htp . @ØŒ)
  Ú¯-Ù… (chord ge  l)
  Ú¯-Ú© (chord ge ï¸”)
  Ì²    (tap-hold $tt $htl _ @ğŸ” )
)
(defchords ge 15
  (l   ) @Ù…
  (  ï¸”) @Ú©
  (l ï¸”) @Ú¯
)
(deflayer farsi
  @Ø¶    @Øµ    @Ø«    @Ù‚    @Ù    @Øº    @Ø¹    @Ù‡    @Ø®    @Ø­
  @Ø´    @Ø³    @ÛŒ    @Ø¨    @Ù„    @Ø§    @Øª    @Ù†    @Ú¯-Ù…  @Ú¯-Ú©
  @Ø¸    @Ø·    @Ø²    @Ø±    @Ø°    @Ø¯    @Ù¾    @Ùˆ    @.     /
                   @ğŸ”¢    @â£â†‘â†“  â€¹â‡§    @ğŸ”£
)

(deflayer qwerty
   _     _     _     _     _     _     _     _     _     _
   _     _     _     _     _     _     _     _     _     _
   _     _     _     _     _     _     _     _     _    @Ì²
                     _     _     _     _
)
